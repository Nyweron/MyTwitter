var app=angular.module("app",["ngRoute"]);angular.module("app").controller("ApplicationCtrl",["$scope","UserSvc","$location",function(t,o,e){t.$on("login",function(o,e){t.currentUser=e}),t.$on("register",function(o,e){t.registerResponse=e}),t.disableRegisterResponse=function(){t.registerResponse=null},t.logout=function(){console.log("logout"),t.currentUser=null,o.logout(),e.path("/")}}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","$location",function(t,o,e){t.login=function(n,r){o.login(n,r).then(function(o){t.$emit("login",o),e.path("/")})}}]),app.controller("PostsCtrl",["$scope","PostsSvc",function(t,o){t.addPost=function(){t.postBody&&o.create({username:"nyweron",body:t.postBody}).success(function(o){t.postBody=null})},t.$on("ws:new_post",function(o,e){t.$apply(function(){t.posts.unshift(e)})}),o.fetch().success(function(o){t.posts=o})}]),app.service("PostsSvc",["$http",function(t){this.fetch=function(){return t.get("/posts")},this.create=function(o){return t.post("/posts",o)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(t,o){t.register=function(e,n){t.nameRequired="",t.passwordRequired="",t.nameRequired=e?"":"Name Required",t.passwordRequired=n?"":"Password Required",e&&n&&o.register(e,n).then(function(o){t.$emit("register","Konto zarejestrowane poprawnie, zaloguj siÄ™."),t.username="",t.password=""})}}]),angular.module("app").config(["$routeProvider",function(t){t.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"}).when("/logout",{controller:"ApplicationCtrl",templateUrl:"posts.html"})}]),angular.module("app").service("UserSvc",["$http",function(t){var o=this;o.getUser=function(){return t.get("/users").then(function(t){return t.data})},o.login=function(e,n){return t.post("/sessions",{username:e,password:n}).then(function(e){return o.token=e.data,t.defaults.headers.common["X-Auth"]=e.data,o.getUser()})},o.register=function(o,e){return t.post("/users",{username:o,password:e}).then(function(t){return t})},o.logout=function(){delete t.defaults.headers.common["X-Auth"]}}]),angular.module("app").service("WebSocketSvc",["$rootScope",function(t){function o(){return"https:"===window.location.protocol?"wss://"+window.location.host:"ws://"+window.location.host}var e;this.connect=function(){(e=new WebSocket(o())).onopen=function(){console.log("WebSocket connected")},e.onmessage=function(o){var e=JSON.parse(o.data);t.$broadcast("ws:"+e.topic,e.data)}},this.send=function(t,o){var n=JSON.stringify({topic:t,data:o});e.send(n)}}]).run(["WebSocketSvc",function(t){t.connect()}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyIsIndlYnNvY2tldHMuc3ZjLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiVXNlclN2YyIsIiRsb2NhdGlvbiIsIiRvbiIsIl8iLCJ1c2VyIiwiY3VycmVudFVzZXIiLCJyZXNwb25zZSIsInJlZ2lzdGVyUmVzcG9uc2UiLCJkaXNhYmxlUmVnaXN0ZXJSZXNwb25zZSIsImxvZ291dCIsImNvbnNvbGUiLCJsb2ciLCJwYXRoIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidGhlbiIsIiRlbWl0IiwiUG9zdHNTdmMiLCJhZGRQb3N0IiwicG9zdEJvZHkiLCJjcmVhdGUiLCJib2R5Iiwic3VjY2VzcyIsInBvc3QiLCIkYXBwbHkiLCJwb3N0cyIsInVuc2hpZnQiLCJmZXRjaCIsInNlcnZpY2UiLCIkaHR0cCIsInRoaXMiLCJnZXQiLCJyZWdpc3RlciIsIm5hbWVSZXF1aXJlZCIsInBhc3N3b3JkUmVxdWlyZWQiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsInN2YyIsImdldFVzZXIiLCJkYXRhIiwidG9rZW4iLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCIkcm9vdFNjb3BlIiwid2Vic29ja2V0SG9zdCIsIndpbmRvdyIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJob3N0IiwiY29ubmVjdGlvbiIsImNvbm5lY3QiLCJXZWJTb2NrZXQiLCJvbm9wZW4iLCJvbm1lc3NhZ2UiLCJlIiwicGF5bG9hZCIsIkpTT04iLCJwYXJzZSIsIiRicm9hZGNhc3QiLCJ0b3BpYyIsInNlbmQiLCJqc29uIiwic3RyaW5naWZ5IiwicnVu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LEVBQUFOLEtBQUEsVUFDQVYsU0FBQUEsRUFDQUMsU0FBQUEsSUFDQUMsS0FBQSxTQUFBVixHQUNBLE9BQUFBLEtBSUFrQyxFQUFBL0IsT0FBQSxrQkFDQXFCLEVBQUFjLFNBQUFDLFFBQUFDLE9BQUEsY0M3QkFsRCxRQUFBQyxPQUFBLE9BQ0FnQyxRQUFBLGdCQUFBLGFBQUEsU0FBQWtCLEdBRUEsU0FBQUMsSUFDQSxNQUFBLFdBQUFDLE9BQUFDLFNBQUFDLFNBQ0EsU0FBQUYsT0FBQUMsU0FBQUUsS0FHQSxRQUFBSCxPQUFBQyxTQUFBRSxLQUtBLElBQUFDLEVBRUF0QixLQUFBdUIsUUFBQSxZQUNBRCxFQUFBLElBQUFFLFVBQUFQLE1BR0FRLE9BQUEsV0FDQTlDLFFBQUFDLElBQUEsd0JBRUEwQyxFQUFBSSxVQUFBLFNBQUFDLEdBQ0EsSUFBQUMsRUFBQUMsS0FBQUMsTUFBQUgsRUFBQWhCLE1BQ0FLLEVBQUFlLFdBQUEsTUFBQUgsRUFBQUksTUFBQUosRUFBQWpCLFFBSUFYLEtBQUFpQyxLQUFBLFNBQUFELEVBQUFyQixHQUNBLElBQUF1QixFQUFBTCxLQUFBTSxXQUFBSCxNQUFBQSxFQUFBckIsS0FBQUEsSUFDQVcsRUFBQVcsS0FBQUMsT0FFQUUsS0FBQSxlQUFBLFNBQUFDLEdBQ0FBLEVBQUFkIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xyXG4gICAgJ25nUm91dGUnXHJcbl0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAuY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3ZjLCAkbG9jYXRpb24pIHtcclxuICAgICAgICAkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uKF8sIHVzZXIpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlclxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgJHNjb3BlLiRvbigncmVnaXN0ZXInLCBmdW5jdGlvbihfLCByZXNwb25zZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUucmVnaXN0ZXJSZXNwb25zZSA9IHJlc3BvbnNlXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgJHNjb3BlLmRpc2FibGVSZWdpc3RlclJlc3BvbnNlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5yZWdpc3RlclJlc3BvbnNlID0gbnVsbFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImxvZ291dFwiKVxyXG4gICAgICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSBudWxsXHJcbiAgICAgICAgICAgIFVzZXJTdmMubG9nb3V0KClcclxuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKVxyXG4gICAgICAgIH1cclxuICAgIH0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAuY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3ZjLCAkbG9jYXRpb24pIHtcclxuICAgICAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgVXNlclN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbih1c2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9KSIsImFwcC5jb250cm9sbGVyKCdQb3N0c0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFBvc3RzU3ZjKSB7XHJcbiAgICAkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICgkc2NvcGUucG9zdEJvZHkpIHtcclxuICAgICAgICAgICAgUG9zdHNTdmMuY3JlYXRlKHtcclxuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAnbnl3ZXJvbicsXHJcbiAgICAgICAgICAgICAgICBib2R5OiAkc2NvcGUucG9zdEJvZHlcclxuICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbihwb3N0KSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucG9zdEJvZHkgPSBudWxsXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAkc2NvcGUuJG9uKCd3czpuZXdfcG9zdCcsIGZ1bmN0aW9uKF8sIHBvc3QpIHtcclxuICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG5cclxuICAgIFBvc3RzU3ZjLmZldGNoKCkuc3VjY2VzcyhmdW5jdGlvbihwb3N0cykge1xyXG4gICAgICAgICRzY29wZS5wb3N0cyA9IHBvc3RzXHJcbiAgICB9KVxyXG5cclxufSkiLCJhcHAuc2VydmljZSgnUG9zdHNTdmMnLCBbJyRodHRwJywgZnVuY3Rpb24oJGh0dHApIHtcclxuXHJcbiAgICB0aGlzLmZldGNoID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL3Bvc3RzJylcclxuICAgIH1cclxuICAgIHRoaXMuY3JlYXRlID0gZnVuY3Rpb24ocG9zdCkge1xyXG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvcG9zdHMnLCBwb3N0KVxyXG4gICAgfVxyXG59XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuICAgIC5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFVzZXJTdmMpIHtcclxuICAgICAgICAkc2NvcGUucmVnaXN0ZXIgPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgJHNjb3BlLm5hbWVSZXF1aXJlZCA9ICcnXHJcbiAgICAgICAgICAgICRzY29wZS5wYXNzd29yZFJlcXVpcmVkID0gJydcclxuXHJcbiAgICAgICAgICAgIGlmICghdXNlcm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5uYW1lUmVxdWlyZWQgPSAnTmFtZSBSZXF1aXJlZCc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubmFtZVJlcXVpcmVkID0gJyc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5wYXNzd29yZFJlcXVpcmVkID0gJ1Bhc3N3b3JkIFJlcXVpcmVkJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5wYXNzd29yZFJlcXVpcmVkID0gJyc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICBpZiAodXNlcm5hbWUgJiYgcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgICAgIFVzZXJTdmMucmVnaXN0ZXIodXNlcm5hbWUsIHBhc3N3b3JkKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgncmVnaXN0ZXInLCBcIktvbnRvIHphcmVqZXN0cm93YW5lIHBvcHJhd25pZSwgemFsb2d1aiBzacSZLlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXNlcm5hbWUgPSBcIlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYXNzd29yZCA9IFwiXCJcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9IGVsc2Uge31cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuICAgIC5jb25maWcoZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcclxuICAgICAgICAkcm91dGVQcm92aWRlclxyXG4gICAgICAgICAgICAud2hlbignLycsIHsgY29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdHMuaHRtbCcgfSlcclxuICAgICAgICAgICAgLndoZW4oJy9yZWdpc3RlcicsIHsgY29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsIHRlbXBsYXRlVXJsOiAncmVnaXN0ZXIuaHRtbCcgfSlcclxuICAgICAgICAgICAgLndoZW4oJy9sb2dpbicsIHsgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsIHRlbXBsYXRlVXJsOiAnbG9naW4uaHRtbCcgfSlcclxuICAgICAgICAgICAgLndoZW4oJy9sb2dvdXQnLCB7IGNvbnRyb2xsZXI6ICdBcHBsaWNhdGlvbkN0cmwnLCB0ZW1wbGF0ZVVybDogJ3Bvc3RzLmh0bWwnIH0pXHJcbiAgICB9KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4gICAgLnNlcnZpY2UoJ1VzZXJTdmMnLCBmdW5jdGlvbigkaHR0cCkge1xyXG4gICAgICAgIHZhciBzdmMgPSB0aGlzXHJcbiAgICAgICAgc3ZjLmdldFVzZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL3VzZXJzJylcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN2Yy5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL3Nlc3Npb25zJywge1xyXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXHJcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIHN2Yy50b2tlbiA9IHJlc3BvbnNlLmRhdGFcclxuICAgICAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHJlc3BvbnNlLmRhdGFcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdmMuZ2V0VXNlcigpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN2Yy5yZWdpc3RlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL3VzZXJzJywge1xyXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXHJcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc3ZjLmxvZ291dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBkZWxldGUgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddXHJcbiAgICAgICAgfVxyXG4gICAgfSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuICAgIC5zZXJ2aWNlKCdXZWJTb2NrZXRTdmMnLCBmdW5jdGlvbigkcm9vdFNjb3BlKSB7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHdlYnNvY2tldEhvc3QoKSB7XHJcbiAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09IFwiaHR0cHM6XCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIndzczovL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3RcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ3czovL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3RcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBjb25uZWN0aW9uXHJcblxyXG4gICAgICAgIHRoaXMuY29ubmVjdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldCh3ZWJzb2NrZXRIb3N0KCkpXHJcblxyXG5cclxuICAgICAgICAgICAgY29ubmVjdGlvbi5vbm9wZW4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdXZWJTb2NrZXQgY29ubmVjdGVkJylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXlsb2FkID0gSlNPTi5wYXJzZShlLmRhdGEpXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ3dzOicgKyBwYXlsb2FkLnRvcGljLCBwYXlsb2FkLmRhdGEpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VuZCA9IGZ1bmN0aW9uKHRvcGljLCBkYXRhKSB7XHJcbiAgICAgICAgICAgIHZhciBqc29uID0gSlNPTi5zdHJpbmdpZnkoeyB0b3BpYzogdG9waWMsIGRhdGE6IGRhdGEgfSlcclxuICAgICAgICAgICAgY29ubmVjdGlvbi5zZW5kKGpzb24pXHJcbiAgICAgICAgfVxyXG4gICAgfSkucnVuKGZ1bmN0aW9uKFdlYlNvY2tldFN2Yykge1xyXG4gICAgICAgIFdlYlNvY2tldFN2Yy5jb25uZWN0KClcclxuICAgIH0pIl19
