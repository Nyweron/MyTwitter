var app=angular.module("app",["ngRoute"]);angular.module("app").controller("ApplicationCtrl",["$scope","UserSvc","$location",function(t,e,n){t.$on("login",function(e,n){t.currentUser=n}),t.$on("register",function(e,n){t.registerResponse=n}),t.disableRegisterResponse=function(){t.registerResponse=null},t.logout=function(){t.currentUser=null,e.logout(),n.path("/")},e.isSessionActive()&&(e.setXAuth(),e.getUser().then(function(e){t.currentUser=e}))}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","$location",function(t,e,n){t.login=function(o,r){e.login(o,r).then(function(e){t.$emit("login",e),n.path("/")})}}]),app.controller("PostsCtrl",["$scope","PostsSvc",function(t,e){t.addPost=function(){t.postBody&&e.create({username:"nyweron",body:t.postBody}).success(function(e){t.postBody=null})},t.$on("ws:new_post",function(e,n){t.$apply(function(){t.posts.unshift(n)})}),e.fetch().success(function(e){t.posts=e})}]),app.service("PostsSvc",["$http",function(t){this.fetch=function(){return t.get("/posts")},this.create=function(e){return t.post("/posts",e)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(t,e){t.register=function(n,o){t.nameRequired="",t.passwordRequired="",t.nameRequired=n?"":"Name Required",t.passwordRequired=o?"":"Password Required",n&&o&&e.register(n,o).then(function(e){t.$emit("register","Konto zarejestrowane poprawnie, zaloguj siÄ™."),t.username="",t.password=""})}}]),angular.module("app").config(["$routeProvider",function(t){t.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"}).when("/logout",{controller:"ApplicationCtrl",templateUrl:"posts.html"})}]),angular.module("app").service("UserSvc",["$http","$window",function(t,e){var n=this;n.getUser=function(){return t.get("/users").then(function(t){return t.data})},n.login=function(e,o){return t.post("/sessions",{username:e,password:o}).then(function(e){return n.token=e.data,n.setToken(n.token),t.defaults.headers.common["X-Auth"]=e.data,n.getUser()})},n.register=function(e,n){return t.post("/users",{username:e,password:n}).then(function(t){return t})},n.logout=function(){e.localStorage.clear(),delete t.defaults.headers.common["X-Auth"]},n.setToken=function(t){return e.localStorage.token=t},n.getToken=function(){return e.localStorage.token},n.isSessionActive=function(){return!!e.localStorage.token},n.setXAuth=function(){return t.defaults.headers.common["X-Auth"]=n.getToken()}}]),angular.module("app").service("WebSocketSvc",["$rootScope",function(t){function e(){return"https:"===window.location.protocol?"wss://"+window.location.host:"ws://"+window.location.host}var n;this.connect=function(){(n=new WebSocket(e())).onopen=function(){console.log("WebSocket connected")},n.onmessage=function(e){var n=JSON.parse(e.data);t.$broadcast("ws:"+n.topic,n.data)}},this.send=function(t,e){var o=JSON.stringify({topic:t,data:e});n.send(o)}}]).run(["WebSocketSvc",function(t){t.connect()}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyIsIndlYnNvY2tldHMuc3ZjLmpzIl0sIm5hbWVzIjpbImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiVXNlclN2YyIsIiRsb2NhdGlvbiIsIiRvbiIsIl8iLCJ1c2VyIiwiY3VycmVudFVzZXIiLCJyZXNwb25zZSIsInJlZ2lzdGVyUmVzcG9uc2UiLCJkaXNhYmxlUmVnaXN0ZXJSZXNwb25zZSIsImxvZ291dCIsInBhdGgiLCJpc1Nlc3Npb25BY3RpdmUiLCJzZXRYQXV0aCIsImdldFVzZXIiLCJ0aGVuIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiJGVtaXQiLCJQb3N0c1N2YyIsImFkZFBvc3QiLCJwb3N0Qm9keSIsImNyZWF0ZSIsImJvZHkiLCJzdWNjZXNzIiwicG9zdCIsIiRhcHBseSIsInBvc3RzIiwidW5zaGlmdCIsImZldGNoIiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImdldCIsInJlZ2lzdGVyIiwibmFtZVJlcXVpcmVkIiwicGFzc3dvcmRSZXF1aXJlZCIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwid2hlbiIsInRlbXBsYXRlVXJsIiwiJHdpbmRvdyIsInN2YyIsImRhdGEiLCJ0b2tlbiIsInNldFRva2VuIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIiwibG9jYWxTdG9yYWdlIiwiY2xlYXIiLCJnZXRUb2tlbiIsIiRyb290U2NvcGUiLCJ3ZWJzb2NrZXRIb3N0Iiwid2luZG93IiwibG9jYXRpb24iLCJwcm90b2NvbCIsImhvc3QiLCJjb25uZWN0aW9uIiwiY29ubmVjdCIsIldlYlNvY2tldCIsIm9ub3BlbiIsImNvbnNvbGUiLCJsb2ciLCJvbm1lc3NhZ2UiLCJlIiwicGF5bG9hZCIsIkpTT04iLCJwYXJzZSIsIiRicm9hZGNhc3QiLCJ0b3BpYyIsInNlbmQiLCJqc29uIiwic3RyaW5naWZ5IiwicnVuIiwiV2ViU29ja2V0U3ZjIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFBQSxJQUFBQyxRQUFBQyxPQUFBLE9BQ0EsWUNEQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLG1CQUFBLFNBQUEsVUFBQSxZQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0FGLEVBQUFHLElBQUEsUUFBQSxTQUFBQyxFQUFBQyxHQUNBTCxFQUFBTSxZQUFBRCxJQUVBTCxFQUFBRyxJQUFBLFdBQUEsU0FBQUMsRUFBQUcsR0FDQVAsRUFBQVEsaUJBQUFELElBRUFQLEVBQUFTLHdCQUFBLFdBQ0FULEVBQUFRLGlCQUFBLE1BRUFSLEVBQUFVLE9BQUEsV0FDQVYsRUFBQU0sWUFBQSxLQUNBTCxFQUFBUyxTQUNBUixFQUFBUyxLQUFBLE1BR0FWLEVBQUFXLG9CQUNBWCxFQUFBWSxXQUNBWixFQUFBYSxVQUFBQyxLQUFBLFNBQUFWLEdBQ0FMLEVBQUFNLFlBQUFELFFDcEJBUixRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsYUFBQSxTQUFBLFVBQUEsWUFBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUNBRixFQUFBZ0IsTUFBQSxTQUFBQyxFQUFBQyxHQUNBakIsRUFBQWUsTUFBQUMsRUFBQUMsR0FDQUgsS0FBQSxTQUFBVixHQUNBTCxFQUFBbUIsTUFBQSxRQUFBZCxHQUNBSCxFQUFBUyxLQUFBLFdDTkFmLElBQUFHLFdBQUEsYUFBQSxTQUFBLFdBQUEsU0FBQUMsRUFBQW9CLEdBQ0FwQixFQUFBcUIsUUFBQSxXQUNBckIsRUFBQXNCLFVBQ0FGLEVBQUFHLFFBQ0FOLFNBQUEsVUFDQU8sS0FBQXhCLEVBQUFzQixXQUNBRyxRQUFBLFNBQUFDLEdBQ0ExQixFQUFBc0IsU0FBQSxRQU1BdEIsRUFBQUcsSUFBQSxjQUFBLFNBQUFDLEVBQUFzQixHQUNBMUIsRUFBQTJCLE9BQUEsV0FDQTNCLEVBQUE0QixNQUFB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QUFBM0IsS0FBQUEsSUFDQWUsRUFBQWEsS0FBQUMsT0FFQUUsS0FBQSxlQUFBLFNBQUFDLEdBQ0FBLEVBQUFoQiIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcclxuICAgICduZ1JvdXRlJ1xyXG5dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgVXNlclN2YywgJGxvY2F0aW9uKSB7XHJcbiAgICAgICAgJHNjb3BlLiRvbignbG9naW4nLCBmdW5jdGlvbihfLCB1c2VyKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IHVzZXJcclxuICAgICAgICB9KVxyXG4gICAgICAgICRzY29wZS4kb24oJ3JlZ2lzdGVyJywgZnVuY3Rpb24oXywgcmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnJlZ2lzdGVyUmVzcG9uc2UgPSByZXNwb25zZVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgJHNjb3BlLmRpc2FibGVSZWdpc3RlclJlc3BvbnNlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5yZWdpc3RlclJlc3BvbnNlID0gbnVsbFxyXG4gICAgICAgIH1cclxuICAgICAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IG51bGxcclxuICAgICAgICAgICAgVXNlclN2Yy5sb2dvdXQoKVxyXG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoVXNlclN2Yy5pc1Nlc3Npb25BY3RpdmUoKSkge1xyXG4gICAgICAgICAgICBVc2VyU3ZjLnNldFhBdXRoKClcclxuICAgICAgICAgICAgVXNlclN2Yy5nZXRVc2VyKCkudGhlbihmdW5jdGlvbih1c2VyKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgVXNlclN2YywgJGxvY2F0aW9uKSB7XHJcbiAgICAgICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIFVzZXJTdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24odXNlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnbG9naW4nLCB1c2VyKVxyXG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJylcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfSkiLCJhcHAuY29udHJvbGxlcignUG9zdHNDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBQb3N0c1N2Yykge1xyXG4gICAgJHNjb3BlLmFkZFBvc3QgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoJHNjb3BlLnBvc3RCb2R5KSB7XHJcbiAgICAgICAgICAgIFBvc3RzU3ZjLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogJ255d2Vyb24nLFxyXG4gICAgICAgICAgICAgICAgYm9keTogJHNjb3BlLnBvc3RCb2R5XHJcbiAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBvc3RCb2R5ID0gbnVsbFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgJHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KSB7XHJcbiAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdClcclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBQb3N0c1N2Yy5mZXRjaCgpLnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdHMpIHtcclxuICAgICAgICAkc2NvcGUucG9zdHMgPSBwb3N0c1xyXG4gICAgfSlcclxuXHJcbn0pIiwiYXBwLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgWyckaHR0cCcsIGZ1bmN0aW9uKCRodHRwKSB7XHJcbiAgICB0aGlzLmZldGNoID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL3Bvc3RzJylcclxuICAgIH1cclxuICAgIHRoaXMuY3JlYXRlID0gZnVuY3Rpb24ocG9zdCkge1xyXG4gICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvcG9zdHMnLCBwb3N0KVxyXG4gICAgfVxyXG59XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuICAgIC5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFVzZXJTdmMpIHtcclxuICAgICAgICAkc2NvcGUucmVnaXN0ZXIgPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgJHNjb3BlLm5hbWVSZXF1aXJlZCA9ICcnXHJcbiAgICAgICAgICAgICRzY29wZS5wYXNzd29yZFJlcXVpcmVkID0gJydcclxuXHJcbiAgICAgICAgICAgIGlmICghdXNlcm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5uYW1lUmVxdWlyZWQgPSAnTmFtZSBSZXF1aXJlZCc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubmFtZVJlcXVpcmVkID0gJyc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5wYXNzd29yZFJlcXVpcmVkID0gJ1Bhc3N3b3JkIFJlcXVpcmVkJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5wYXNzd29yZFJlcXVpcmVkID0gJyc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICBpZiAodXNlcm5hbWUgJiYgcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgICAgIFVzZXJTdmMucmVnaXN0ZXIodXNlcm5hbWUsIHBhc3N3b3JkKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgncmVnaXN0ZXInLCBcIktvbnRvIHphcmVqZXN0cm93YW5lIHBvcHJhd25pZSwgemFsb2d1aiBzacSZLlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXNlcm5hbWUgPSBcIlwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wYXNzd29yZCA9IFwiXCJcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9IGVsc2Uge31cclxuICAgICAgICB9XHJcbiAgICB9KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkcm91dGVQcm92aWRlcikge1xyXG4gICAgICAgICRyb3V0ZVByb3ZpZGVyXHJcbiAgICAgICAgICAgIC53aGVuKCcvJywgeyBjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgdGVtcGxhdGVVcmw6ICdwb3N0cy5odG1sJyB9KVxyXG4gICAgICAgICAgICAud2hlbignL3JlZ2lzdGVyJywgeyBjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJywgdGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJyB9KVxyXG4gICAgICAgICAgICAud2hlbignL2xvZ2luJywgeyBjb250cm9sbGVyOiAnTG9naW5DdHJsJywgdGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJyB9KVxyXG4gICAgICAgICAgICAud2hlbignL2xvZ291dCcsIHsgY29udHJvbGxlcjogJ0FwcGxpY2F0aW9uQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdHMuaHRtbCcgfSlcclxuICAgIH0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAuc2VydmljZSgnVXNlclN2YycsIGZ1bmN0aW9uKCRodHRwLCAkd2luZG93KSB7XHJcbiAgICAgICAgdmFyIHN2YyA9IHRoaXNcclxuICAgICAgICBzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvdXNlcnMnKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgICAgc3ZjLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvc2Vzc2lvbnMnLCB7XHJcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcclxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgc3ZjLnRva2VuID0gcmVzcG9uc2UuZGF0YVxyXG4gICAgICAgICAgICAgICAgc3ZjLnNldFRva2VuKHN2Yy50b2tlbilcclxuICAgICAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHJlc3BvbnNlLmRhdGFcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdmMuZ2V0VXNlcigpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN2Yy5yZWdpc3RlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL3VzZXJzJywge1xyXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXHJcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgICAgICBzdmMubG9nb3V0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICR3aW5kb3cubG9jYWxTdG9yYWdlLmNsZWFyKClcclxuICAgICAgICAgICAgZGVsZXRlICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXVxyXG4gICAgICAgIH1cclxuICAgICAgICBzdmMuc2V0VG9rZW4gPSBmdW5jdGlvbih0b2tlbikge1xyXG4gICAgICAgICAgICByZXR1cm4gJHdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW4gPSB0b2tlblxyXG4gICAgICAgIH1cclxuICAgICAgICBzdmMuZ2V0VG9rZW4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN2Yy5pc1Nlc3Npb25BY3RpdmUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICR3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuID8gdHJ1ZSA6IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN2Yy5zZXRYQXV0aCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gc3ZjLmdldFRva2VuKClcclxuICAgICAgICB9XHJcbiAgICB9KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4gICAgLnNlcnZpY2UoJ1dlYlNvY2tldFN2YycsIGZ1bmN0aW9uKCRyb290U2NvcGUpIHtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gd2Vic29ja2V0SG9zdCgpIHtcclxuICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCA9PT0gXCJodHRwczpcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwid3NzOi8vXCIgKyB3aW5kb3cubG9jYXRpb24uaG9zdFxyXG5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIndzOi8vXCIgKyB3aW5kb3cubG9jYXRpb24uaG9zdFxyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGNvbm5lY3Rpb25cclxuXHJcbiAgICAgICAgdGhpcy5jb25uZWN0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHdlYnNvY2tldEhvc3QoKSlcclxuXHJcblxyXG4gICAgICAgICAgICBjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1dlYlNvY2tldCBjb25uZWN0ZWQnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBheWxvYWQgPSBKU09OLnBhcnNlKGUuZGF0YSlcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZW5kID0gZnVuY3Rpb24odG9waWMsIGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIGpzb24gPSBKU09OLnN0cmluZ2lmeSh7IHRvcGljOiB0b3BpYywgZGF0YTogZGF0YSB9KVxyXG4gICAgICAgICAgICBjb25uZWN0aW9uLnNlbmQoanNvbilcclxuICAgICAgICB9XHJcbiAgICB9KS5ydW4oZnVuY3Rpb24oV2ViU29ja2V0U3ZjKSB7XHJcbiAgICAgICAgV2ViU29ja2V0U3ZjLmNvbm5lY3QoKVxyXG4gICAgfSkiXX0=
